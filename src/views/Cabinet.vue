<script setup lang="ts">
import DocumentBlack from '/img/cabinet/icons/document-black.svg'

import { useRoute } from 'vue-router'
import router from '@/router'

import { Api } from '@/api/api'
import { User } from '@/api/user'

let ApiClass = new Api()
let UserClass = new User()

import LeftArticles from '@/components/home/LeftArticles.vue'
import VacationModal from '@/components/cabinet/VacationModal.vue'
import EducationModal from '@/components/cabinet/EducationModal.vue'
import JobModal from '@/components/cabinet/JobModal.vue'
import { onMounted, type Prop, ref } from 'vue'

const route = useRoute()

let user: Prop<Object> = ref('')

onMounted(async () => {
  const response = await UserClass.getUserData(localStorage.getItem('token'))
  user.value = response.data.data

  console.log(user.value)
})

function onSettingsClick() {
  const login = route.params.login
  router.push({ name: 'settings', params: { login: login } })
}

function onVacationModalClick() {
  document.getElementById('vacation-modal')?.classList.toggle('modal-hidden')
}
function onEducationModalClick() {
  document.getElementById('education-modal')?.classList.toggle('modal-hidden')
}
function onJobModalClick() {
  document.getElementById('job-modal')?.classList.toggle('modal-hidden')
}
</script>

<template>
  <div class="cabinet-block" v-if="Object.keys(user).length">
    <div class="left">
      <div class="about-user-profile-main-block">
        <div class="photo">
          <span class="bg-circle"></span>
          <img :src="user.avatar" alt="" class="user-image rounded-circle" />
        </div>

        <div class="about-user">
          <div class="name">
            <h1>{{ user.name }}</h1>
          </div>
          <div class="job-info">
            <h2>Отдел досуга</h2>
            <hr />
            <h2>Менеджер по креативу</h2>
          </div>
          <div class="boss">
            <h3>Непосредственный руководитель:</h3>
            <h4>Корнеева Наталья</h4>
          </div>
          <div class="contact">
            <div class="phone-number">
              <img src="/icons/phone-blue.svg" alt="" />
              <p>{{ user.phone }}</p>
              <img src="" alt="" />
            </div>
            <div class="email">
              <img src="/icons/email-blue.svg" alt="" />
              <p>{{ user.email }}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="l-footer">
        <h2>Мои заявки:</h2>
        <div class="requests">
          <div class="one-request">
            <div class="request-title">
              <img src="" alt="" />
              <h3>Заявка на обучение</h3>
            </div>
            <div class="response">
              <p>Одобренно</p>
              <img src="" alt="" />
            </div>
          </div>

          <div class="one-request">
            <div class="request-title">
              <img src="" alt="" />
              <h3>Заявка на обучение</h3>
            </div>
            <div class="response">
              <p>Одобренно</p>
              <img src="" alt="" />
            </div>
          </div>
          <div class="one-request">
            <div class="request-title">
              <img src="" alt="" />
              <h3>Заявка на обучение</h3>
            </div>
            <div class="response">
              <p>Одобренно</p>
              <img src="" alt="" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="right">
      <div class="r-left">
        <div @click="onSettingsClick()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="stroke"
          >
            <path
              d="M13.4492 6.95241L17.0492 10.5524M4.44922 19.5524L8.8152 18.6727C9.04698 18.626 9.2598 18.5119 9.42693 18.3446L19.2006 8.56559C19.6692 8.09674 19.6689 7.33675 19.1999 6.86829L17.1295 4.80021C16.6607 4.33194 15.9011 4.33226 15.4327 4.80092L5.65798 14.581C5.49117 14.7479 5.37727 14.9603 5.33052 15.1916L4.44922 19.5524Z"
              stroke="#474747"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>

          Редактировать профиль
        </div>

        <div @click="onJobModalClick()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="fill"
          >
            <path
              d="M15.95 6.5V6.55H16H19C19.7824 6.55 20.5327 6.8608 21.086 7.41404C21.6392 7.96727 21.95 8.71761 21.95 9.5V18.5C21.95 19.2824 21.6392 20.0327 21.086 20.586C20.5327 21.1392 19.7824 21.45 19 21.45H5C4.21761 21.45 3.46727 21.1392 2.91404 20.586C2.3608 20.0327 2.05 19.2824 2.05 18.5V9.5C2.05 8.71761 2.3608 7.96727 2.91404 7.41404C3.46727 6.8608 4.21761 6.55 5 6.55H8H8.05V6.5V5.5C8.05 4.71761 8.3608 3.96727 8.91403 3.41404C9.46727 2.8608 10.2176 2.55 11 2.55H13C13.7824 2.55 14.5327 2.8608 15.086 3.41404C15.6392 3.96727 15.95 4.71761 15.95 5.5V6.5ZM14 6.55H14.05V6.5V5.5C14.05 5.22152 13.9394 4.95445 13.7425 4.75754C13.5455 4.56062 13.2785 4.45 13 4.45H11C10.7215 4.45 10.4545 4.56062 10.2575 4.75754C10.0606 4.95445 9.95 5.22152 9.95 5.5V6.5V6.55H10H14ZM4.01844 12.9535L3.95 12.9264V13V18.5C3.95 18.7785 4.06062 19.0455 4.25754 19.2425C4.45445 19.4394 4.72152 19.55 5 19.55H19C19.2785 19.55 19.5455 19.4394 19.7425 19.2425C19.9394 19.0455 20.05 18.7785 20.05 18.5V13V12.9264L19.9816 12.9535C17.4409 13.9604 14.7329 14.4783 12 14.48C9.26698 14.4793 6.55882 13.9613 4.01844 12.9535ZM20.0201 10.8558L20.05 10.8426V10.81V9.5C20.05 9.22152 19.9394 8.95445 19.7425 8.75754C19.5455 8.56063 19.2785 8.45 19 8.45H5C4.72152 8.45 4.45445 8.56063 4.25754 8.75754C4.06062 8.95445 3.95 9.22152 3.95 9.5V10.81V10.8426L3.97989 10.8558C6.50783 11.9663 9.23887 12.5398 12 12.5398C14.7611 12.5398 17.4922 11.9663 20.0201 10.8558Z"
              fill="#474747"
              stroke="white"
              stroke-width="0.1"
            />
          </svg>
          Заявка на командировку
        </div>
        <div @click="onEducationModalClick()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="fill"
          >
            <path
              d="M20.4666 9.68379L20.4668 9.68389L21.4664 10.2337C21.4664 10.2337 21.4665 10.2337 21.4665 10.2338C21.6132 10.3162 21.7353 10.4362 21.8204 10.5814C21.9056 10.7266 21.9506 10.8918 21.9509 11.0602V14.5001C21.9509 14.752 21.8508 14.9937 21.6726 15.1718C21.4944 15.35 21.2528 15.4501 21.0009 15.4501C20.7489 15.4501 20.5073 15.35 20.3291 15.1718C20.1509 14.9937 20.0509 14.752 20.0509 14.5001V11.6401V11.5548L19.9764 11.5965L17.9764 12.7165L17.9509 12.7308V12.7601V17.5001C17.9509 18.2825 17.6401 19.0328 17.0868 19.586C16.5336 20.1393 15.7832 20.4501 15.0009 20.4501H7.00085C6.21847 20.4501 5.46812 20.1393 4.91489 19.586C4.36166 19.0328 4.05085 18.2825 4.05085 17.5001V12.7601V12.7306L4.02509 12.7163L1.53551 11.3366C1.53544 11.3365 1.53537 11.3365 1.5353 11.3365C1.38919 11.2536 1.26766 11.1335 1.18309 10.9884C1.09848 10.8432 1.05391 10.6781 1.05391 10.5101C1.05391 10.342 1.09848 10.177 1.18309 10.0318C1.26766 9.88665 1.3892 9.76654 1.53532 9.68369C1.53538 9.68365 1.53544 9.68361 1.53551 9.68358L10.5238 4.69008H10.6209H10.6305L10.6394 4.6865C10.6999 4.6623 10.7623 4.64343 10.826 4.63008H11.0009H11.1855C11.2457 4.64335 11.3046 4.66211 11.3614 4.68613L11.3707 4.69008H11.3809H11.4779L20.4666 9.68379ZM6.0251 13.8263L5.95085 13.7852V13.8701V17.5001C5.95085 17.7786 6.06148 18.0456 6.25839 18.2425C6.45531 18.4395 6.72238 18.5501 7.00085 18.5501H15.0009C15.2793 18.5501 15.5464 18.4395 15.7433 18.2425C15.9402 18.0456 16.0509 17.7786 16.0509 17.5001V13.8701V13.7852L15.9766 13.8263L11.4666 16.3263L11.4666 16.3263L11.4646 16.3275C11.4248 16.3521 11.3811 16.3699 11.3355 16.3801H11.2509V16.3797L11.2446 16.3805C11.1657 16.3904 11.086 16.3904 11.0071 16.3805L11.0073 16.3789L10.9946 16.3805C10.9157 16.3904 10.836 16.3904 10.7571 16.3805L10.7572 16.3801H10.7509H10.6705L10.5323 16.3248L6.0251 13.8263ZM10.9766 14.4038L11.0009 14.4173L11.0252 14.4038L17.9652 10.5438L18.0437 10.5001L17.9652 10.4564L11.0252 6.59638L11.0009 6.58286L10.9766 6.59638L4.03655 10.4564L3.95799 10.5001L4.03655 10.5438L10.9766 14.4038Z"
              fill="#474747"
              stroke="white"
              stroke-width="0.1"
            />
          </svg>

          Заявка на обучение
        </div>
        <div @click="onVacationModalClick()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="stroke"
          >
            <path
              d="M13 8C13 5.24 10.54 3 7.5 3C4.46 3 2 5.24 2 8H4L5 7L6 8H10M13 7.14C14.0126 6.39135 15.2407 5.99134 16.5 6C19.54 6 22 8.24 22 11H19L18 10L17 11H14"
              stroke="#474747"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M5.89009 9.71046C3.74009 11.8605 3.59009 15.1805 5.54009 17.1405L9.78009 12.8905L10.4801 12.1905L11.1901 11.4805L13.3101 9.36046C11.3601 7.40046 8.04009 7.56046 5.89009 9.71046Z"
              stroke="#474747"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M11 15.5C11.5 18 10.83 20 10 22H14C16 16.5 13.5 10 13 8"
              stroke="#474747"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>

          Заявка на отпуск
        </div>
        <div>
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="fill"
          >
            <path
              d="M19.89 8.67V8.67818L19.8926 8.68594C19.9207 8.76934 19.9399 8.85545 19.95 8.94285V8.94311V8.94345V8.94378V8.94412V8.94445V8.94479V8.94512V8.94545V8.94578V8.94611V8.94643V8.94676V8.94708V8.94741V8.94773V8.94805V8.94837V8.94868V8.949V8.94931V8.94963V8.94994V8.95025V8.95056V8.95087V8.95118V8.95148V8.95179V8.95209V8.95239V8.95269V8.95299V8.95329V8.95359V8.95388V8.95418V8.95447V8.95476V8.95505V8.95534V8.95563V8.95592V8.9562V8.95649V8.95677V8.95705V8.95733V8.95761V8.95789V8.95817V8.95844V8.95872V8.95899V8.95926V8.95953V8.9598V8.96007V8.96034V8.96061V8.96087V8.96113V8.9614V8.96166V8.96192V8.96218V8.96244V8.96269V8.96295V8.9632V8.96346V8.96371V8.96396V8.96421V8.96446V8.9647V8.96495V8.9652V8.96544V8.96568V8.96592V8.96617V8.9664V8.96664V8.96688V8.96712V8.96735V8.96758V8.96782V8.96805V8.96828V8.96851V8.96874V8.96896V8.96919V8.96941V8.96964V8.96986V8.97008V8.9703V8.97052V8.97074V8.97096V8.97117V8.97139V8.9716V8.97182V8.97203V8.97224V8.97245V8.97266V8.97287V8.97307V8.97328V8.97348V8.97369V8.97389V8.97409V8.97429V8.97449V8.97469V8.97488V8.97508V8.97528V8.97547V8.97566V8.97586V8.97605V8.97624V8.97643V8.97661V8.9768V8.97699V8.97717V8.97736V8.97754V8.97772V8.9779V8.97808V8.97826V8.97844V8.97862V8.97879V8.97897V8.97914V8.97932V8.97949V8.97966V8.97983V8.98V8.98017V8.98034V8.9805V8.98067V8.98083V8.981V8.98116V8.98132V8.98148V8.98164V8.9818V8.98196V8.98212V8.98227V8.98243V8.98258V8.98274V8.98289V8.98304V8.98319V8.98334V8.98349V8.98364V8.98379V8.98393V8.98408V8.98422V8.98437V8.98451V8.98465V8.9848V8.98494V8.98507V8.98521V8.98535V8.98549V8.98562V8.98576V8.98589V8.98603V8.98616V8.98629V8.98642V8.98655V8.98668V8.98681V8.98694V8.98706V8.98719V8.98732V8.98744V8.98756V8.98769V8.98781V8.98793V8.98805V8.98817V8.98829V8.98841V8.98852V8.98864V8.98876V8.98887V8.98898V8.9891V8.98921V8.98932V8.98943V8.98954V8.98965V8.98976V8.98987V8.98997V8.99008V8.99019V8.99029V8.9904V8.9905V8.9906V8.9907V8.9908V8.9909V8.991V8.9911V8.9912V8.9913V8.99139V8.99149V8.99159V8.99168V8.99177V8.99187V8.99196V8.99205V8.99214V8.99223V8.99232V8.99241V8.9925V8.99259V8.99267V8.99276V8.99285V8.99293V8.99301V8.9931V8.99318V8.99326V8.99334V8.99343V8.99351V8.99359V8.99366V8.99374V8.99382V8.9939V8.99397V8.99405V8.99412V8.9942V8.99427V8.99435V8.99442V8.99449V8.99456V8.99463V8.9947V8.99477V8.99484V8.99491V8.99498V8.99504V8.99511V8.99517V8.99524V8.9953V8.99537V8.99543V8.99549V8.99556V8.99562V8.99568V8.99574V8.9958V8.99586V8.99592V8.99598V8.99603V8.99609V8.99615V8.9962V8.99626V8.99632V8.99637V8.99642V8.99648V8.99653V8.99658V8.99663V8.99669V8.99674V8.99679V8.99684V8.99688V8.99693V8.99698V8.99703V8.99708V8.99712V8.99717V8.99722V8.99726V8.9973V8.99735V8.99739V8.99744V8.99748V8.99752V8.99756V8.9976V8.99764V8.99769V8.99773V8.99776V8.9978V8.99784V8.99788V8.99792V8.99795V8.99799V8.99803V8.99806V8.9981V8.99813V8.99817V8.9982V8.99824V8.99827V8.9983V8.99834V8.99837V8.9984V8.99843V8.99846V8.99849V8.99852V8.99855V8.99858V8.99861V8.99864V8.99866V8.99869V8.99872V8.99875V8.99877V8.9988V8.99883V8.99885V8.99888V8.9989V8.99892V8.99895V8.99897V8.99899V8.99902V8.99904V8.99906V8.99908V8.99911V8.99913V8.99915V8.99917V8.99919V8.99921V8.99923V8.99925V8.99927V8.99928V8.9993V8.99932V8.99934V8.99935V8.99937V8.99939V8.9994V8.99942V8.99944V8.99945V8.99947V8.99948V8.9995V8.99951V8.99953V8.99954V8.99955V8.99957V8.99958V8.99959V8.9996V8.99962V8.99963V8.99964V8.99965V8.99966V8.99967V8.99968V8.9997V8.99971V8.99972V8.99973V8.99973V8.99974V8.99975V8.99976V8.99977V8.99978V8.99979V8.9998V8.9998V8.99981V8.99982V8.99983V8.99985V8.99986V8.99987V8.99988V8.99989V8.9999V8.99991V8.99992V8.99993V8.99994V8.99995V8.99996V8.99996V8.99997V8.99998V8.99999V9V19C19.95 19.7824 19.6392 20.5327 19.086 21.086C18.5327 21.6392 17.7824 21.95 17 21.95H7C6.21761 21.95 5.46727 21.6392 4.91404 21.086C4.3608 20.5327 4.05 19.7824 4.05 19V5C4.05 4.21761 4.3608 3.46727 4.91404 2.91404C5.46727 2.3608 6.21761 2.05 7 2.05H13.0469C13.1554 2.0638 13.2602 2.09893 13.3551 2.15337L13.3667 2.16H13.38H13.4587C13.5527 2.20517 13.6392 2.26448 13.7152 2.33589L19.7141 8.33482C19.7855 8.41082 19.8448 8.4973 19.89 8.59125V8.67ZM14.0354 5.37464L13.95 5.28929V5.41V7C13.95 7.27848 14.0606 7.54555 14.2575 7.74246C14.4545 7.93937 14.7215 8.05 15 8.05H16.59H16.7107L16.6254 7.96464L14.0354 5.37464ZM12.05 4V3.95H12H7C6.72152 3.95 6.45445 4.06062 6.25754 4.25754C6.06062 4.45445 5.95 4.72152 5.95 5V19C5.95 19.2785 6.06062 19.5455 6.25754 19.7425C6.45445 19.9394 6.72152 20.05 7 20.05H17C17.2785 20.05 17.5455 19.9394 17.7425 19.7425C17.9394 19.5455 18.05 19.2785 18.05 19V10V9.95H18H15C14.2176 9.95 13.4673 9.6392 12.914 9.08597C12.3608 8.53273 12.05 7.78239 12.05 7V4Z"
              fill="#474747"
              stroke="white"
              stroke-width="0.1"
            />
          </svg>

          Заказать справку
        </div>
      </div>
      <div class="r-right">
        <LeftArticles />
      </div>
    </div>

    <!-- Modals goes here -->
    <VacationModal />
    <EducationModal />
    <JobModal />
  </div>
</template>
